<core:FragmentDefinition
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:l="sap.ui.layout"
    xmlns:f="sap.ui.layout.form"
    xmlns:u="sap.ui.unified"
>
    <Dialog
        stretch="{= ${device>/system/phone} }"
        contentWidth="80%"
        contentHeight="auto"
        resizable="true"
        draggable="true"
    >
        <customHeader>
            <Bar class="profileHeaderBar">
                <contentMiddle>
                    <Title
                        text="My Account"
                        level="H4"
                    />
                </contentMiddle>
                <contentRight>
                    <Button
                        icon="sap-icon://decline"
                        type="Transparent"
                        press="onProfileDialogClose"
                    />
                </contentRight>
            </Bar>
        </customHeader>
        <HBox
            class="sapUiMediumMargin responsiveProfileBox"
            justifyContent="Start"
            alignItems="Start"
        >
            <VBox
                width="180px"
                alignItems="Center"
                class="sapUiMediumMarginEnd"
            >
                <Avatar
                    src="{path: 'profileData>/photo'}"
                    initials="{profileData>/initials}"
                    displayShape="Circle"
                    displaySize="XL"
                    press="onPreviewProfilePhoto"
                />

                <Button
                    id="id_avatarEditBtn"
                    icon="sap-icon://edit"
                    press="onPressAvatarEdit"
                    class="avatarEditIcon"
                />

                <u:FileUploader
                    id="id_fileUploaderAvatar"
                    uploadOnChange="false"
                    change="onAvatarFileSelected"
                    fileType="png,jpg,jpeg"
                    class="hiddenUploader"
                    buttonOnly="true"
                    iconOnly="true"
                />
            </VBox>
            
                <VBox width="100%"> 
                <Toolbar>
                <ToolbarSpacer/>
                <Button
                    text="{= ${profileData>/isEditMode} ? 'Save' : 'Edit'}"
                    press="onEditSaveProfile"
                    class="myUnifiedBtn"
                />
                </Toolbar>
                <f:Form editable="false">
                <f:layout>
                    <f:ColumnLayout
                        columnsXL="3"
                        columnsL="3"
                        columnsM="1"
                    />
                </f:layout>

                <f:formContainers>
                    <f:FormContainer>
                        <f:formElements>
                            <f:FormElement label="Full Name">
                                <f:fields>
                                
                                     <Text
                                text="{= ${profileData>/Salutation} + ' ' + ${profileData>/name}}"
                            />
                                </f:fields>
                            </f:FormElement>

                            <f:FormElement label="Email">
                                <f:fields>
                                    <Text text="{profileData>/email}" />
                                </f:fields>
                            </f:FormElement>

                            <f:FormElement label="City">
                                <f:fields>
                                    <Text text="{profileData>/city}" />
                                </f:fields>
                            </f:FormElement>

                            <f:FormElement label="Date of Birth">
                                <f:fields>
                                    <Text text="{profileData>/dob}" />
                                </f:fields>
                            </f:FormElement>

                            <f:FormElement label="Country">
                                <f:fields>
                                    <Text text="{profileData>/country}" />
                                </f:fields>
                            </f:FormElement>

                            <f:FormElement label="Mobile Number">
                                <f:fields>
                                    <Text text="{= ${profileData>/stdCode} + ' ' + ${profileData>/phone}}" />
                                </f:fields>
                            </f:FormElement>

                            <f:FormElement label="Gender">
                                <f:fields>
                                    <Text text="{profileData>/gender}" />
                                </f:fields>
                            </f:FormElement>

                            <f:FormElement label="State">
                                <f:fields>
                                    <Text text="{profileData>/state}" />
                                </f:fields>
                            </f:FormElement>

                            <f:FormElement label="Address">
                                <f:fields>
                                    <Text
                                        text="{profileData>/address}"
                                        wrapping="true"
                                    />
                                </f:fields>
                            </f:FormElement>
                        </f:formElements>
                    </f:FormContainer>
                </f:formContainers>
            </f:Form>
            </VBox> 
        </HBox>
        <Table
            id="Id_ProfileaTable"
            mode="SingleSelectLeft"
            noDataText="No booking history found"
            items="{
                    path: 'profileData>/bookings',
                    sorter: [
                        { path: 'bookingGroup', descending: false, group: true },
                        { path: 'Startdate', descending: true }
                    ]
                }"
        >
            <headerToolbar>
                <OverflowToolbar>
                    <Title
                        text="Booking History ({=${profileData>/bookings}.length})"
                    />
                    <ToolbarSpacer />
                </OverflowToolbar>
            </headerToolbar>

            <columns>
                <Column demandPopin="true">
                    <Text text="Customer Name" />
                </Column>
                <Column demandPopin="true">
                    <Text text="Start Date" />
                </Column>
                <Column demandPopin="true">
                    <Text text="Room" />
                </Column>
                <Column
                    demandPopin="true"
                    minScreenWidth="Tablet"
                >
                    <Text text="Amount" />
                </Column>
                <Column
                    demandPopin="true"
                    minScreenWidth="Tablet"
                >
                    <Text text="Status" />
                </Column>
            </columns>

            <items>
                <ColumnListItem
                    type="Navigation"
                    press="onPressBookingRow"
                >
                    <cells>
                        <Text text="{profileData>customerName}" />
                        <Text text="{profileData>Startdate}" />
                        <Text text="{profileData>room}" />
                         <Text text="{path:'profileData>amount', formatter: '.Formatter.formatCurrency'}"/>
                        <Text text="{profileData>status}" />
                    </cells>
                </ColumnListItem>
            </items>
        </Table>
    </Dialog>
</core:FragmentDefinition>