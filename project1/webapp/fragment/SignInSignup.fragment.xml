<core:FragmentDefinition 
	xmlns="sap.m" 
	xmlns:core="sap.ui.core" 
	xmlns:f="sap.ui.layout.form" 
	xmlns:l="sap.ui.layout">
	<Dialog id="authDialog" draggable="true" resizable="true" class="authDialog" contentWidth="auto" contentHeight="auto">
		<customHeader>
			<Bar>
				<contentMiddle>
					<Title text="Hostel Access Portal" />
				</contentMiddle>
				<contentRight>
					<Button type="Transparent" icon="sap-icon://decline" press="onDialogClose" />
				</contentRight>
			</Bar>
		</customHeader>
		<VBox>
			<!-- Switch Button -->
			<HBox justifyContent="Center" class="switch-toggle-container" visible="{= ${LoginViewModel>/authFlow} === 'signin' || ${LoginViewModel>/authFlow} === 'signup' }">
				<Button text="SIGN IN" type="Transparent" class="switch-toggle-btn {= ${LoginViewModel>/selectedAccountType} === 'personal' ? 'active' : 'inactive'}" press="onSwitchToSignIn" />
				<Button id="signupvisible" text="SIGN UP" type="Transparent" class="switch-toggle-btn {= ${LoginViewModel>/selectedAccountType} === 'biz' ? 'active' : 'inactive'}" press="onSwitchToSignUp" />
			</HBox>
			<!-- Sign In Panel -->

			<Panel id="signInPanel" expandable="false">
	<VBox>
		<Label text="User ID" required="true" />
		<Input id="signInuserid" placeholder="User ID" valueLiveUpdate="true" liveChange="onUserlivechange" valueStateText="Please enter a valid User ID" />
		<Label text="User Name" required="true" />
		<Input id="signInusername" placeholder="User Name" valueLiveUpdate="true" liveChange="onUserlivechange" valueStateText="Please enter a valid User Name"/>
		<Label text="Login with" />
<HBox alignItems="End" justifyContent="Start">
	<RadioButton text="Password" groupName="loginType" selected="{LoginViewModel>/isPasswordSelected}" select="onSelectLoginMode" />
	<RadioButton text="OTP" groupName="loginType" selected="{LoginViewModel>/isOtpSelected}" select="onSelectLoginMode" />
	<Button id="btnSignInSendOTP" text="Send OTP" visible="{LoginViewModel>/isOtpSelected}" press="onPressOTP" />
</HBox>
		<!-- PASSWORD SECTION -->
		<Label text="Password" required="true" id="lblPass" visible="{LoginViewModel>/isPasswordSelected}"/>
		<Input id="signinPassword" placeholder="Enter Password" submit="onSignIn"  type="Password" visible="{LoginViewModel>/isPasswordSelected}" showValueHelp="true" valueHelpIconSrc="sap-icon://show" valueHelpRequest="SM_onTogglePasswordVisibility" liveChange="onSigninPasswordLive" />
		<!-- REUSED OTP FIELD FOR LOGIN -->
		<VBox id="signInOTPBox" visible="{LoginViewModel>/isOtpBoxVisible}">
			<Label text="Enter OTP" required="true" />
			<Input id="signInOTP" placeholder="Enter OTP" liveChange="onLoginOtpLive" maxLength="6" type="Number" />
		</VBox>
		<HBox justifyContent="SpaceBetween" class="sapUiTinyMarginTop">
			<Button text="Forgot Password?" type="Transparent" press="onForgotPassword"/>
			<!-- <Button text="Sign In" type="Accept" width="100px" press="onSignIn"/> -->
			<Button text="Sign In" type="Accept" width="100px" 
			enabled="{= ${LoginViewModel>/isPasswordSelected} || ${LoginViewModel>/isOtpSelected} &amp;&amp; ${LoginViewModel>/isOtpEntered} }" press="onSignIn"/>
		</HBox>
	</VBox>
</Panel>



<!-- FORGOT FLOW IN ONE PANEL -->
<Panel id="forgotFlowPanel" expandable="false" visible="false" class="forgotPanel">
<HBox justifyContent="Center" class="switch-toggle-container" />
<!-- <Title  text=""/>
</HBox> -->
	<VBox id="forgotVBox">
		<!-- STEP 1: SEND OTP -->
		<VBox id="fpStepUser">
			<Label text="Enter User ID" />
			<Input id="fpUserId" placeholder="Your User ID" liveChange="onFPValidate"/>
			<Label text="Enter User Name" />
			<Input id="fpUserName" placeholder="Registered Name" liveChange="onFPValidate"/>
			<HBox justifyContent="End" >
			<Button id="btnFPNext" text="Send OTP" type="Emphasized" enabled="false" press="onValidateUser"/>
			</HBox>
		</VBox>
		<!-- STEP 2: OTP (Initially hidden) -->
		<VBox id="fpStepOtp" visible="false" class="sapUiSmallMarginTop">
			<Label text="Enter OTP" />
			<Input id="fpOTP" placeholder="Enter OTP" liveChange="onOtpLive"/>
			<HBox justifyContent="End">
			<Button id="btnOtpVerify" text="Verify OTP" enabled="false" type="Accept" press="_onVerifyOTP"/>
			</HBox>
		</VBox>
		<!-- STEP 3: RESET PASSWORD (Initially hidden) -->
		<VBox id="fpStepReset" visible="false" class="sapUiSmallMarginTop">
			<Label text="New Password"/>
			<Input id="newPass" type="Password" showValueHelp="true" valueHelpIconSrc="sap-icon://show" valueHelpRequest=".SM_onTogglePasswordVisibility" />
			<Label text="Confirm Password"/>
		<Input id="confPass" type="Password" showValueHelp="true" valueHelpIconSrc="sap-icon://show" valueHelpRequest=".SM_onTogglePasswordVisibility" />
			<HBox justifyContent="End">
			<Button id="btnUpdatePass" text="Update Password" type="Accept" press="onSubmitNewPassword"/>
			</HBox>
		</VBox>
		<Button text="Back to Login" type="Transparent" class="sapUiTinyMarginTop" press="onBackToLogin"/>
	</VBox>
</Panel>





































			<!-- Sign Up Panel -->
			<Panel id="signUpPanel" expandable="false" visible="false">
				<content>
					<f:SimpleForm id="signUpForm" editable="true" layout="ResponsiveGridLayout" labelSpanL="3" labelSpanM="3" emptySpanL="1" emptySpanM="1" columnsL="2" columnsM="1" class="sapUiNoContentPadding sapUiSmallMarginTop">
						<Label text=""/>
						<HBox width="100%" alignItems="Center" justifyContent="Start">
							<VBox width="20%">
								<Label text="Salutation" required="true"/>
								<ComboBox id="signUpSalutation" selectedKey="" change="onChangeSalutation" placeholder="Select" valueStateText="Select Salutation">
									<core:ListItem key="Mr." text="Mr."/>
									<core:ListItem key="Ms." text="Ms."/>
									<core:ListItem key="Mrs." text="Mrs."/>
									<core:ListItem key="Dr." text="Dr."/>
								</ComboBox>
							</VBox>
							<VBox width="80%" class="sapUiTinyMarginBegin">
								<Label text="Full Name" required="true"/>
								<Input id="signUpName" value="{LoginMode>/fullname}" placeholder="Full Name" required="true" liveChange="_LCvalidateName" valueStateText="Enter valid name"/>
							</VBox>
						</HBox>
						<Label text="Date Of Birth" required="true"/>
						<DatePicker id="signUpDOB" displayFormat="dd-MM-yyyy" valueFormat="yyyy-MM-dd" change="onChangeDOB" />
						<Label text="Gender" required="true"/>
						<Select id="signUpGender" selectedKey="" change="onChangeGender">
							<core:Item key="" text="Select Gender" />
							<core:Item key="Male" text="Male"/>
							<core:Item key="Female" text="Female"/>
							<core:Item key="Other" text="Other"/>
						</Select>
						<!-- ================== 2) CONTACT DETAILS ================== -->
						<Label text="Email" required="true"/>
						<Input id="signUpEmail" value="{LoginMode>/Email}" placeholder="Email" type="Email" required="true" liveChange="onEmailliveChange" valueStateText="Enter valid email" />
						<Label text="Country" required="true"/>
						<ComboBox id="signUpCountry" change="onChangeCountry" selectionChange="onChangeCountry" placeholder="Select Country" valueStateText="Select a valid Country" items="{path:'CountryModel>/', length:1000}" showSecondaryValues="true">
							<core:ListItem key="{CountryModel>countryName}" text="{CountryModel>countryName}" additionalText="{CountryModel>code}"/>
						</ComboBox>
						<Label text="State" required="true"/>
						<ComboBox id="signUpState" change="onChangeState" selectionChange="onChangeState" placeholder="Select State" valueStateText="Select a valid State" items="{path:'StateModel>/', length:1000}" showSecondaryValues="true">
							<core:ListItem key="{StateModel>stateName}" text="{StateModel>stateName}"/>
						</ComboBox>
						<Label text="City" required="true"/>
						<ComboBox id="signUpCity" change="onChangeCity" selectionChange="onChangeCity" placeholder="Select City" valueStateText="Select a valid City" items="{path:'CityModel>/', length:1000}" showSecondaryValues="true">
							<core:ListItem key="{CityModel>cityName}" text="{CityModel>cityName}" additionalText="{CityModel>branchCode}"/>
						</ComboBox>
						<Label text=""/>
						<HBox width="100%" alignItems="Center" justifyContent="Start">
							<VBox width="26%">
								<Label text="ISD Code" required="true"/>
								<ComboBox id="signUpSTD" placeholder="Code" valueStateText="Select Code" showSecondaryValues="true" items="{path:'CountryModel>/', length:1000}">
									<core:ListItem key="{CountryModel>stdCode}" text="{CountryModel>stdCode}" additionalText="{CountryModel>code}" />
								</ComboBox>
							</VBox>
							<VBox width="74%" class="sapUiTinyMarginBegin">
								<Label text="Mobile Number" required="true"/>
								<Input id="signUpPhone" value="{LoginMode>/Mobileno}" placeholder="Enter Contact Number" maxLength="18" liveChange="onMobileLivechnage" valueStateText="Enter a valid mobile number" required="true" />
							</VBox>
						</HBox>
						<Label text="Address" required="true"/>
						<TextArea id="signUpAddress" rows="3" maxLength="500" value="{LoginMode>/Address}" liveChange="onAddressChange" placeholder="Address" />
						<HBox width="100%">
							<Label text="Account Security" design="Bold" class="sapUiSmallMarginTop"/>
						</HBox>
						<!-- <Title text="Account Security" /> -->
						<Label text="Create Password" required="true" />
						<Input id="signUpPassword" placeholder="Enter Password" value="{LoginMode>/password}" valueState="{LoginViewModel>/frgNewPasswordValueState}" type="Password" liveChange="SM_onChnageSetAndConfirm" showValueHelp="true" valueStateText="Password must contain 1 uppercase, 1 lowercase, 1 number &amp; 1 special character" valueHelpIconSrc="sap-icon://show" valueHelpRequest="SM_onTogglePasswordVisibility" maxLength="50" />
						<Label text="Confirm Password" required="true" />
						<Input id="signUpConfirmPassword" placeholder="Enter Confirm Password" value="{LoginMode>/comfirmpass}" type="Password" change="FSM_onConfirm" liveChange="FSM_onConfirm" showValueHelp="true" valueStateText="Enter Confirm Password" valueHelpIconSrc="sap-icon://show" valueHelpRequest="SM_onTogglePasswordVisibility" maxLength="50"/>
					</f:SimpleForm>
					<HBox justifyContent="End" class="sapUiSmallMarginTop">
						<Button text="Sign Up" type="Emphasized" width="120px" press="onSignUp"/>
					</HBox>
				</content>
			</Panel>
			</VBox>

	</Dialog>
</core:FragmentDefinition>